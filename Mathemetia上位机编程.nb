(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     17998,        443]
NotebookOptionsPosition[     17551,        423]
NotebookOutlinePosition[     17909,        439]
CellTagsIndexPosition[     17866,        436]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"dev", "=", 
   RowBox[{"DeviceOpen", "[", 
    RowBox[{"\"\<Serial\>\"", ",", 
     RowBox[{"{", 
      RowBox[{"\"\<COM3\>\"", ",", 
       RowBox[{"\"\<BaudRate\>\"", "\[Rule]", "115200"}], ",", 
       RowBox[{"\"\<DataBits\>\"", "\[Rule]", "8"}], ",", 
       RowBox[{"\"\<StopBits\>\"", "\[Rule]", "1"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{
  3.668569118744073*^9, {3.66857324326556*^9, 3.668573246968156*^9}, 
   3.668573575065405*^9}],

Cell[BoxData[
 RowBox[{"DeviceClose", "[", "dev", "]"}]], "Input",
 CellChangeTimes->{{3.668497455245242*^9, 3.668497459928926*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"program", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"DeviceReadBuffer", "[", "dev", "]"}], ";", 
    RowBox[{"DeviceReadBuffer", "[", "dev", "]"}], ";", 
    RowBox[{"DeviceWrite", "[", 
     RowBox[{"dev", ",", "\"\<1\>\""}], "]"}], ";", 
    RowBox[{"Pause", "[", "10", "]"}], ";", 
    RowBox[{"Day1data", "=", 
     RowBox[{"FromCharacterCode", "[", 
      RowBox[{"DeviceReadBuffer", "[", "dev", "]"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"volt1", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"1", ",", "48"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"volt2", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"1", ",", "48"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"temp", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"1", ",", "48"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"press", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"1", ",", "48"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"volt1", "[", 
          RowBox[{"[", "n", "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{"ToExpression", "[", 
           RowBox[{
            RowBox[{"StringSplit", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Interpreter", "[", "List", "]"}], "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Interpreter", "[", "List", "]"}], "[", 
                  RowBox[{"ToString", "[", "Day1data", "]"}], "]"}], "[", 
                 RowBox[{"[", "n", "]"}], "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<,\>\""}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], "/", "1000"}]}], ",", 
        RowBox[{
         RowBox[{"volt2", "[", 
          RowBox[{"[", "n", "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{"ToExpression", "[", 
           RowBox[{
            RowBox[{"StringSplit", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Interpreter", "[", "List", "]"}], "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Interpreter", "[", "List", "]"}], "[", 
                  RowBox[{"ToString", "[", "Day1data", "]"}], "]"}], "[", 
                 RowBox[{"[", "n", "]"}], "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<,\>\""}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}], "/", "1000"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"temp", "[", 
          RowBox[{"[", "n", "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{"ToExpression", "[", 
           RowBox[{
            RowBox[{"StringSplit", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Interpreter", "[", "List", "]"}], "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Interpreter", "[", "List", "]"}], "[", 
                  RowBox[{"ToString", "[", "Day1data", "]"}], "]"}], "[", 
                 RowBox[{"[", "n", "]"}], "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<,\>\""}], "]"}], "[", 
            RowBox[{"[", "3", "]"}], "]"}], "]"}], "/", "100"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"press", "[", 
          RowBox[{"[", "n", "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{"ToExpression", "[", 
           RowBox[{
            RowBox[{"StringSplit", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Interpreter", "[", "List", "]"}], "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Interpreter", "[", "List", "]"}], "[", 
                  RowBox[{"ToString", "[", "Day1data", "]"}], "]"}], "[", 
                 RowBox[{"[", "n", "]"}], "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<,\>\""}], "]"}], "[", 
            RowBox[{"[", "4", "]"}], "]"}], "]"}], "/", "10000"}]}]}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "48"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"now", "=", 
     RowBox[{"DateObject", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"ToExpression", "[", 
          RowBox[{
           RowBox[{"StringSplit", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Interpreter", "[", "List", "]"}], "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Interpreter", "[", "List", "]"}], "[", 
                 RowBox[{"ToString", "[", "Day1data", "]"}], "]"}], "[", 
                RowBox[{"[", "49", "]"}], "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<,\>\""}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
         RowBox[{"ToExpression", "[", 
          RowBox[{
           RowBox[{"StringSplit", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Interpreter", "[", "List", "]"}], "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Interpreter", "[", "List", "]"}], "[", 
                 RowBox[{"ToString", "[", "Day1data", "]"}], "]"}], "[", 
                RowBox[{"[", "49", "]"}], "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<,\>\""}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
         RowBox[{"ToExpression", "[", 
          RowBox[{
           RowBox[{"StringSplit", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Interpreter", "[", "List", "]"}], "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Interpreter", "[", "List", "]"}], "[", 
                 RowBox[{"ToString", "[", "Day1data", "]"}], "]"}], "[", 
                RowBox[{"[", "49", "]"}], "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<,\>\""}], "]"}], "[", 
           RowBox[{"[", "3", "]"}], "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"ToExpression", "[", 
          RowBox[{
           RowBox[{"StringSplit", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Interpreter", "[", "List", "]"}], "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Interpreter", "[", "List", "]"}], "[", 
                 RowBox[{"ToString", "[", "Day1data", "]"}], "]"}], "[", 
                RowBox[{"[", "49", "]"}], "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<,\>\""}], "]"}], "[", 
           RowBox[{"[", "4", "]"}], "]"}], "]"}], ",", 
         RowBox[{"ToExpression", "[", 
          RowBox[{
           RowBox[{"StringSplit", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Interpreter", "[", "List", "]"}], "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Interpreter", "[", "List", "]"}], "[", 
                 RowBox[{"ToString", "[", "Day1data", "]"}], "]"}], "[", 
                RowBox[{"[", "49", "]"}], "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<,\>\""}], "]"}], "[", 
           RowBox[{"[", "5", "]"}], "]"}], "]"}], ",", 
         RowBox[{"ToExpression", "[", 
          RowBox[{
           RowBox[{"StringSplit", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Interpreter", "[", "List", "]"}], "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Interpreter", "[", "List", "]"}], "[", 
                 RowBox[{"ToString", "[", "Day1data", "]"}], "]"}], "[", 
                RowBox[{"[", "49", "]"}], "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<,\>\""}], "]"}], "[", 
           RowBox[{"[", "6", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"aweekago", "=", 
     RowBox[{"DateObject", "[", 
      RowBox[{
       RowBox[{"DayPlus", "[", 
        RowBox[{"now", ",", 
         RowBox[{"-", "100"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"ToExpression", "[", 
          RowBox[{
           RowBox[{"StringSplit", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Interpreter", "[", "List", "]"}], "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Interpreter", "[", "List", "]"}], "[", 
                 RowBox[{"ToString", "[", "Day1data", "]"}], "]"}], "[", 
                RowBox[{"[", "49", "]"}], "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<,\>\""}], "]"}], "[", 
           RowBox[{"[", "4", "]"}], "]"}], "]"}], ",", 
         RowBox[{"ToExpression", "[", 
          RowBox[{
           RowBox[{"StringSplit", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Interpreter", "[", "List", "]"}], "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Interpreter", "[", "List", "]"}], "[", 
                 RowBox[{"ToString", "[", "Day1data", "]"}], "]"}], "[", 
                RowBox[{"[", "49", "]"}], "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<,\>\""}], "]"}], "[", 
           RowBox[{"[", "5", "]"}], "]"}], "]"}], ",", 
         RowBox[{"ToExpression", "[", 
          RowBox[{
           RowBox[{"StringSplit", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Interpreter", "[", "List", "]"}], "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Interpreter", "[", "List", "]"}], "[", 
                 RowBox[{"ToString", "[", "Day1data", "]"}], "]"}], "[", 
                RowBox[{"[", "49", "]"}], "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<,\>\""}], "]"}], "[", 
           RowBox[{"[", "6", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"label", "=", 
     RowBox[{"\"\<  Volt1=\>\"", "<>", 
      RowBox[{"ToString", "[", 
       RowBox[{"N", "[", 
        RowBox[{
         RowBox[{"ToExpression", "[", 
          RowBox[{
           RowBox[{"StringSplit", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Interpreter", "[", "List", "]"}], "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Interpreter", "[", "List", "]"}], "[", 
                 RowBox[{"ToString", "[", "Day1data", "]"}], "]"}], "[", 
                RowBox[{"[", "48", "]"}], "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<,\>\""}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], "/", "1000"}], "]"}], "]"}],
       "<>", "\"\<v   Volt2=\>\"", "<>", 
      RowBox[{"ToString", "[", 
       RowBox[{"N", "[", 
        RowBox[{
         RowBox[{"ToExpression", "[", 
          RowBox[{
           RowBox[{"StringSplit", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Interpreter", "[", "List", "]"}], "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Interpreter", "[", "List", "]"}], "[", 
                 RowBox[{"ToString", "[", "Day1data", "]"}], "]"}], "[", 
                RowBox[{"[", "48", "]"}], "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<,\>\""}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}], "/", "1000"}], "]"}], "]"}],
       "<>", "\[IndentingNewLine]", "\"\<v\\nTemp=\>\"", "<>", 
      RowBox[{"ToString", "[", 
       RowBox[{"N", "[", 
        RowBox[{
         RowBox[{"ToExpression", "[", 
          RowBox[{
           RowBox[{"StringSplit", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Interpreter", "[", "List", "]"}], "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Interpreter", "[", "List", "]"}], "[", 
                 RowBox[{"ToString", "[", "Day1data", "]"}], "]"}], "[", 
                RowBox[{"[", "48", "]"}], "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<,\>\""}], "]"}], "[", 
           RowBox[{"[", "3", "]"}], "]"}], "]"}], "/", "10"}], "]"}], "]"}], 
      "<>", "\"\<'C      Press=\>\"", "<>", 
      RowBox[{"ToString", "[", 
       RowBox[{"N", "[", 
        RowBox[{
         RowBox[{"ToExpression", "[", 
          RowBox[{
           RowBox[{"StringSplit", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Interpreter", "[", "List", "]"}], "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Interpreter", "[", "List", "]"}], "[", 
                 RowBox[{"ToString", "[", "Day1data", "]"}], "]"}], "[", 
                RowBox[{"[", "48", "]"}], "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<,\>\""}], "]"}], "[", 
           RowBox[{"[", "4", "]"}], "]"}], "]"}], "/", "1000"}], "]"}], "]"}],
       "<>", "\"\<kPa\\n  \>\""}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"pic", "=", 
     RowBox[{"DateListPlot", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"volt1", ",", "volt2", ",", "temp", ",", "press"}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"now", ",", "aweekago"}], "}"}], ",", 
       RowBox[{"PlotLegends", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Volt1", ",", "Volt2", ",", "Temp", ",", "Press"}], "}"}]}], 
       ",", 
       RowBox[{"PlotLabel", "\[Rule]", "label"}]}], "]"}]}], ";"}], 
   "}"}]}]], "Input",
 CellChangeTimes->{{3.668500822934557*^9, 3.6685008421009893`*^9}, 
   3.6685009072205334`*^9, {3.6685009433975816`*^9, 3.668500960192201*^9}, {
   3.668501005043109*^9, 3.668501049868286*^9}, {3.6685011109299603`*^9, 
   3.66850118028548*^9}, {3.66856964760882*^9, 3.6685696620607386`*^9}, {
   3.6685698461741257`*^9, 3.668569857701167*^9}, {3.6685700979137583`*^9, 
   3.668570101969984*^9}, {3.668570378813328*^9, 3.668570392753927*^9}, {
   3.6685704341216946`*^9, 3.6685704356259155`*^9}, {3.668570736295768*^9, 
   3.6685707403269215`*^9}, {3.6685715374453535`*^9, 
   3.6685715395051084`*^9}, {3.668571863272052*^9, 3.668571873228321*^9}, {
   3.6685723811462903`*^9, 3.668572382320964*^9}, {3.668572645085653*^9, 
   3.668572671813779*^9}, {3.668572745956689*^9, 3.6685727463777423`*^9}, {
   3.6685728648755198`*^9, 3.668572912955724*^9}, 3.6685729518882537`*^9, {
   3.668573038419402*^9, 3.668573045826638*^9}, {3.668573304101939*^9, 
   3.6685733191225476`*^9}, {3.668573450744932*^9, 3.6685734619823136`*^9}, {
   3.668573871669153*^9, 3.6685738992138214`*^9}, {3.6685740423488426`*^9, 
   3.6685740441121893`*^9}, {3.6685742544492097`*^9, 
   3.6685742557058973`*^9}, {3.66857478955133*^9, 3.6685747952166786`*^9}, {
   3.6685749211869264`*^9, 3.668574924026931*^9}, {3.66857516050836*^9, 
   3.6685751901535044`*^9}},
 NumberMarks->False],

Cell[BoxData[
 RowBox[{"{", "Null", "}"}]], "Output",
 CellChangeTimes->{3.6685771745340986`*^9, 3.6685773384157324`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"RunScheduledTask", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"program", ";", 
      RowBox[{"CloudDeploy", "[", 
       RowBox[{"pic", ",", "\"\<121270014\>\"", ",", 
        RowBox[{"Permissions", "\[Rule]", "\"\<Public\>\""}]}], "]"}]}], 
     "}"}], ",", "60"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.668571929677458*^9, 3.6685720126748977`*^9}, {
   3.6685721345266495`*^9, 3.6685721396099825`*^9}, {3.6685727354179587`*^9, 
   3.6685727600636673`*^9}, 3.66857295802592*^9, {3.6685731404625864`*^9, 
   3.6685731470151587`*^9}, {3.668573181215164*^9, 3.6685731894305906`*^9}, {
   3.668573380351791*^9, 3.6685734233007693`*^9}, {3.668573480406887*^9, 
   3.668573503321865*^9}, {3.6685735393097725`*^9, 3.66857354695149*^9}, 
   3.66857382143976*^9, 3.6685771055113215`*^9, {3.6685771986324873`*^9, 
   3.6685772010769405`*^9}}]
},
WindowSize->{1366, 685},
WindowMargins->{{1358, Automatic}, {-4, Automatic}},
FrontEndVersion->"10.2 for Microsoft Windows (64-bit) (2015\:5e747\:67087\
\:65e5)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 500, 13, 48, "Input"],
Cell[1061, 35, 132, 2, 48, "Input"],
Cell[CellGroupData[{
Cell[1218, 41, 15308, 356, 1096, "Input"],
Cell[16529, 399, 121, 2, 31, "Output"]
}, Open  ]],
Cell[16665, 404, 882, 17, 48, "Input"]
}
]
*)

(* End of internal cache information *)
